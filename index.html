<!DOCTYPE html>

<html lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <title>TGRASS: temporal data processing with GRASS GIS</title>
  <meta name="description" content="Short course TGRASS: temporal data processing with GRASS GIS">
  <meta name="author" content="Veronica Andreo, Luca Delucchi, Markus Neteler">
  <link rel="shortcut icon" href="grass.png">

  <script type="text/javascript" src="lib/jquery.js"></script>
  <script type="text/javascript" src="lib/codetabs.js"></script>

<!--
<link rel="stylesheet" href="http://yandex.st/highlightjs/8.0/styles/default.min.css">
<script src="http://yandex.st/highlightjs/8.0/highlight.min.js"></script>
-->

  <script type="text/javascript" src="lib/highlights/highlight.pack.js"></script>
  <link rel="stylesheet" href="lib/highlights/styles/default.css">
  <link rel="stylesheet" href="css/grassdocs.css">
  <link rel="stylesheet" href="css/codetabs.css">

<style type="text/css">
.hljs{
    display: none;
    /*padding: 0em;*/
}
</style>

</head>

<body>

  <div id="container">
    <a href="https://europe.foss4g.org/2017/" title="FOSS4G EU 2017"><img src="foss4g_eu_2017.png" width="22%" height="22%" align="left" alt="FOSS4G EU 2017 logo">
    </a><a href="https://grass.osgeo.org" title="GRASS GIS"><img src="grassgis_logo_colorlogo_text_whitebg.png" width="18.5%" height="18.5%" align="right" alt="GRASS GIS logo"></a>
    <h1 align="center">TGRASS: temporal data processing with GRASS GIS</h1>
    <h2 class="notoc" align="center">FOSS4G Europe 2017 workshop</h2>
    <p align="center">
    <a href="https://veroandreo.wordpress.com/" target="_blank">Veronica Andreo</a>, <a href="http://www.lucadelu.org" target="_blank">Luca Delucchi</a> and <a href="https://www.mundialis.de/en/neteler/" target="_blank">Markus Neteler</a>
<!--
	meter una animacion de NC
-->
    </p>
    <p style="border-top-style: solid; border-bottom-style: solid; border-width: 5px; border-color: rgb(130, 130, 130); padding-top: 5px;">

    <p>
    Course outline:
    <ul>
        <li><a href="#grassgisintro">Introduction to GRASS GIS</a></li>
        <li><a href="#temporalintro">Introduction to GRASS Temporal Framework</a></li>
        <li><a href="#temporalhands">Hands-on to raster time series processing</a></li>
    </ul>
    </p>
    <p>
    Software requirements:
    <ul>
        <li>GRASS GIS 7.2: <a href="https://grass.osgeo.org/download/software/">download</a> | <a href="https://live.osgeo.org/">OSGeo-live</a></li>
        <li>
            GRASS GIS Add-ons: <a href="https://grass.osgeo.org/grass72/manuals/addons/r.modis.download.html">r.modis.download</a>,
            <a href="https://grass.osgeo.org/grass72/manuals/addons/r.modis.import.html">r.modis.import</a> and
            <a href="https://grass.osgeo.org/grass72/manuals/addons/v.strds.stats.html">v.strds.stats</a>
        </li>
        <li> <a href="http://www.pymodis.org">pyModis</a> library</li>
<!--
	<li>matplotlib with pyplot
	(included in GRASS installation for MS Windows; package python-matplotlib for Ubuntu)</li>
	we also need PLY for t.rast.algebra
-->
    </ul>
    </p>
    <p>
    Sample data:
    <ul>
        <li>Main dataset: <a href="https://grass.osgeo.org/sampledata/north_carolina/nc_spm_08_grass7.tar.gz">North Carolina basic location (50 MB)</a>
        <ul>
<!-- TODO add url: -->
            <li>extra "mapset" <code>modis_lst</code>: monthly land surface temperature (LST) from MODIS sensor (MOD11B3.006) for North Carolina (2015-2016)</li>
        </ul>
    </ul>
    </p>
    <p style="border-top-style: solid; border-bottom-style: solid; border-width: 5px; border-color: rgb(130, 130, 130); padding-top: 5px;">

    <p>
    <h2><a name="grassgisintro">GRASS GIS introduction</a></h2>
    
    Working with GRASS GIS is not much different from any other GIS. Just a few commonly used terms need to be introduced first.

    <h3>GRASS DATABASE, LOCATION and MAPSET</h3>
    The <b>GRASS DATABASE</b> (also called "GISDBASE") is an existing directory which contains all GRASS GIS projects. These projects are organized in subdirectories called LOCATIONs.<br>
    A <b>LOCATION</b> is defined by its coordinate system, map projection and geographical boundaries.<br>
    In a <b>MAPSET</b> you can organize GIS maps thematically or geographically or by project or whatever.<br>
    <div class="imagebox">
        <img style="width: 65%;" src="figures/grass_database.png" alt="GRASS DATABASE, LOCATIONs, and MAPSETs" title="GRASS DATABASE, LOCATIONs, and MAPSETs"><br>
        GRASS DATABASE, LOCATIONs and MAPSETs
    </div>

    <h3>Raster and vector maps</h3>
    GRASS GIS is able to read most GIS data formats directly (mainly done through the GDAL library). GRASS GIS has its own internal formats to manage raster and vector data, so own data have to be imported or linked into a GRASS LOCATION/MAPSET.<br>
    The <b>vector format is topological</b>, this means that adjacent geographic components in a single vector map are related to each other. For example, in a non-topological GIS if two areas shared a common border that border would be digitized twice and also stored in a duplicate manner. In a topological GIS such as GRASS GIS this border exists only once and is shared between these two areas. The topological representation of vector data helps to produce and maintain vector maps with clean geometry as well as it enables certain analyses that can not be conducted with non-topological or spaghetti data.<br>
    <div class="imagebox">
        <img style="width: 65%;" src="figures/datatypes.png" alt="Vector data types" title="Vector data types"><br>
        All vector data types in GRASS GIS
    </div>

    <h3>Modules</h3>
    GRASS GIS is composed of 450 and more modules to run any kind of GIS analysis. It is possible to analize raster, raster 3D, imagery and vector maps along with their alphanumerical attributes.<br>
    It is possible to install further modules, called Addons, from a centralized repository at OSGeo or from github using the command  <a href="https://grass.osgeo.org/grass72/manuals/g.extension.html">g.extension</a>.
    The wealth of modules is organized by their first name in order to easily find the desired functionality. The graphical user interface offers a tree view as well as a search engine.
    <p>
    <table style="width:80%" border="1" align="center" bgcolor="#FFFFFF">
	   <caption>GRASS GIS module families</caption>
      <tr>
          <th>Prefix</th>
          <th>Function class</th>
          <th>Type of command</th>
          <th>Example</th>
      </tr>
      <tr>
		  <td>g.*</td>
		  <td>general</td>
		  <td>general data management</td>
		  <td>g.rename: renames map</td>
      </tr>
      <tr>
		  <td>d.*</td>
		  <td>display</td>
		  <td>graphical output</td>
		  <td>d.rast: display raster map, d.vect: display vector map</td>
      </tr>
      <tr>
		  <td>r.*</td>
		  <td>raster</td>
		  <td>raster processing</td>
		  <td>r.mapcalc: map algebra, r.univar: univariate statistics</td>
      </tr>
      <tr>
		  <td>v.*</td>
		  <td>vector</td>
		  <td>vector processing</td>
		  <td>v.clean: topological cleaning</td>
      </tr>
      <tr>
		  <td>i.*</td>
		  <td>imagery</td>
		  <td>imagery processing</td>
		  <td>i.pca: Principal Components Analysis on imagery group</td>
      </tr>
      <tr>
		  <td>r3.*</td>
		  <td>voxel</td>
		  <td>3D raster processing</td>
		  <td>r3.stats: voxel statistics</td>
      </tr>
      <tr>
		  <td>db.*</td>
		  <td>database</td>
		  <td>database management</td>
		  <td>db.select: select value(s) from table</td>
      </tr>
      <tr>
		  <td>ps.*</td>
		  <td>postscript</td>
		  <td>map creation in PostScript format</td>
		  <td>ps.map: PostScript map creation</td>
      </tr>
      <tr>
		  <td>t.*</td>
		  <td>temporal</td>
		  <td>space-time datasets</td>
		  <td>t.rast.aggregate: raster time series aggregation</td>
      </tr>
    </table>
    
    <h3>Region and Mask</h3>
    The <b>computational (or current) region</b> is the <i>actual setting of the region boundaries and the actual raster resolution</i>.<br>
    The raster input maps are automatically cropped/padded and rescaled to match the current region, the output maps have their bounds and resolution equal to those of the current computational region, while vector maps are always considered completely.
    <div class="imagebox">
        <img style="width: 600px;" src="figures/region.png" alt="Show computational region" title="Show computational region"><br>
        The red box shows the computational region currently set
    </div>
    <em>MASK</em>: if the mask is set raster modules will operate only on data falling inside the masked area(s), i.e. any data falling outside of the mask are treated as if their pixel value were NULL. To set the mask you can use <a href="https://grass.osgeo.org/grass72/manuals/r.mask.html" target="_blank">r.mask</a> or creating a raster called <code>MASK</code> (this raster map name is reserved for this purpose).<br>
    <div class="imagebox">
        <img style="width: 600px;" src="figures/mask.png" alt="Show MASK effect" title="Show MASK effect"><br>
        By setting the MASK (here based on a ZIP code) only the raster data inside the masked area are used for further analysis
    </div>

    <h3>Interfaces</h3>
    GRASS GIS offers different interfaces for the interaction between user and software, let's see them...
    <h4>Graphical User Interface</h4>
    The GUI is the simpler way to approach GRASS GIS. The <a href="https://grass.osgeo.org/grass72/manuals/wxGUI.html" target="_blank">GRASS GIS GUI</a> is composed by two elements, the <code>Layer Manager</code> where you can find all the GRASS GIS modules and you can manage your data and, the <code>Map Display</code> where you can navigate, print and query your maps. It also comes with a Python shell for rapid prototyping.
    <div class="imagebox">
        <img style="width: 80%;" src="figures/grass_gis_gui.png" alt="GRASS GIS GUI" title="GRASS GIS GUI"><br>
        GRASS GIS Graphical User Interface (GUI)
    </div>
    Otherwise you can also use GRASS GIS inside QGIS by either using the <code>GRASS GIS plugin</code> or through <code>Processing</code>.
    <h4>Command line</h4>
    The command line is the traditional and, probably, the more powerful way to use GRASS GIS, used daily by many GRASS GIS power users worldwide.
    <h4>Python</h4>
    Python is a powerful and simple programming language, and you can use it to:
    <ul>
        <li>interface with the functionality offered by GRASS GIS</li>
        <li>create your own workflows chaining several GRASS GIS modules</li>
        <li>create new addons by using GRASS GIS modules along with a wide number of Python libraries.</li>
    </ul>
    Here's an example of Python code to run GRASS GIS modules:
    <pre>
		<code class="python">
!/usr/bin/env python

# simple example for pyGRASS usage: raster processing via modules approach

from grass.pygrass.modules.shortcuts import general as g
from grass.pygrass.modules.shortcuts import raster as r

g.message("Filter elevation map by a threshold...")

# set computational region
input = 'elevation'
g.region(rast=input)

# hardcoded:
# r.mapcalc('elev_100m = if(elevation > 100, elevation, null())', overwrite = True)

# with variables
output = 'elev_100m'
thresh = 100.0
r.mapcalc("%s = if(%s > %d, %s, null())" % (output, input, thresh, input), overwrite = True)
r.colors(map=output, color="elevation")
		</code>
    </pre>
    <h4>WPS - OGC Web Processing Service</h4>
    It is possible to run GRASS GIS modules through the web using the <a href="https://en.wikipedia.org/wiki/Web_Processing_Service" target="_blank">Web Processing Service</a> (WPS is an <a href="https://en.wikipedia.org/wiki/Open_Geospatial_Consortium" target="_blank">OGC</a> standard). The Free and Open Source software <a href="http://zoo-project.org/" target="_blank">ZOO-Project</a> and <a href="http://pywps.org/" target="_blank">PyWPS</a> allow the user to run GRASS GIS commands in a simple way.

    <h2><a name="temporalintro">Temporal GRASS GIS introduction</a></h2>
    
    <p>
	GRASS GIS is the first temporal Open Source GIS with capabilities to manage, analyze, process and visualize spatio-temporal data, as well as, the temporal relationships among time series.

    Importantly, the TGRASS concept is based on metadata and does not duplicate any datasets. It uses an SQL database to store the temporal and spatial extension of space-time datasets (STDS), i.e. map metadata, as well as the topological relationships among maps and among STDS.

    <h3>Terminology overview</h3>
    <h4>Temporal database</h4>
    A temporal database is a mapset-specific database in which all time stamped maps are registered,
    i.e.: their spatial and temporal extents, unique ID and map type metadata are stored.
    This allows users to perform complex SQL queries using the spatio-temporal extent and metadata information for map selection.
    <h4>Space-time datasets</h4>
    <ul>
        <li>Space time raster datasets (<b>STRDS</b>) collections of time stamped raster maps.</li>
        <li>Space time 3D raster datasets (<b>STR3DS</b>) collections of time stamped 3D raster maps.</li>
        <li>Space time vector datasets (<b>STVDS</b>) collections of time stamped vector maps.</li>
    </ul>
	<h4>Spatio-temporal modules</h4>
	<ul>
		<li><b>t.*</b>: General modules to handle STDS of all types</li>
		<li><b>t.rast.*</b>: Modules that process specifically STRDS</li>
		<li><b>t.rast3d.*</b>: Modules that process specifically STR3DS</li>
		<li><b>t.vect.*</b>: Modules that process specifically STVDS</li>
	</ul>
    <h4>Absolute time vs relative time</h4>
    <p>
    Two time definitions are used:
    <table style="width:70%" border="1" align="center" bgcolor="#FFFFFF">
      <tr>
        <th>Absolute time</th>
        <th>Relative time</th>
      </tr>
      <tr>
        <td>Gregorian calendar (ISO 8601 time format notation)</td>
        <td>An integer and a time unit (year, month, day, hour, minute, seconds)</td>
      </tr>
      <tr>
        <td>Example: 2013-10-15 13:00:00</td>
        <td>Example: 4 years, 90 days, 1 second</td>
      </tr>
    </table>
    <h4>Time intervals vs time instances</h4>
    <p>
    GRASS GIS supports both, time intervals and time instances:
    <p>
    <table style="width:70%" border="1" align="center" bgcolor="#FFFFFF">
      <tr>
          <th>Time intervals</th>
          <th>Time instances</th>
      </tr>
      <tr>
          <td>Defined by start time and end time: [start, end)</td>
          <td>Defined by start time</td>
      </tr>
      <tr>
          <td>Support for gaps, allow overlapping, might contain time instances, might be irregularly spaced in time</td>
          <td>Punctual event</td>
      </tr>
    </table>
    <h4>Granularity</h4>
    <p>
    The granularity is the largest common divider granule of time intervals and gaps between intervals or instances from all time stamped spatial fields that are collected in a STDS. It is represented as a number of seconds, minutes, hours, days, weeks, months or years.

    <h3>Workflow overview</h3>
<!--
MAKE A NICE FLOWCHART
-->
    <ol>
        <li>Set and connect the temporal database (mapset specific): <a href="https://grass.osgeo.org/grass72/manuals/t.connect.html">t.connect</a></li>
        <li>Create the STDS (raster, vector or raster 3D): <a href="https://grass.osgeo.org/grass72/manuals/t.create.html">t.create</a></li>
        <li>Assign timestamps to maps and register them in the STDS: <a href="https://grass.osgeo.org/grass72/manuals/t.register.html">t.register</a></li>
        <li>
            Check info, integrity and validity of STDS: <a href="https://grass.osgeo.org/grass72/manuals/t.list.html">t.list</a>,
            <a href="https://grass.osgeo.org/grass72/manuals/t.info.html">t.info</a>,
            <a href="https://grass.osgeo.org/grass72/manuals/t.topology.html">t.topology</a>
        </li>
        <li>
            Edition, updating, unregistering, removal of maps and/or STDS: <a href="https://grass.osgeo.org/grass72/manuals/t.rename.html">t.rename</a>,
            <a href="https://grass.osgeo.org/grass72/manuals/t.remove.html">t.remove</a>,
            <a href="https://grass.osgeo.org/grass72/manuals/t.support.html">t.support</a>,
            <a href="https://grass.osgeo.org/grass72/manuals/t.unregister.html">t.unregister</a>
        </li>
        <li>
            Listing maps, selections, univariate statistics:
            <a href="https://grass.osgeo.org/grass72/manuals/t.rast.list.html">t.rast.list</a>,
            <a href="https://grass.osgeo.org/grass72/manuals/t.vect.list.html">t.vect.list</a>,
            <a href="https://grass.osgeo.org/grass72/manuals/t.select.html">t.select</a>,
            <a href="https://grass.osgeo.org/grass72/manuals/t.rast.extract.html">t.rast.extract</a>,
            <a href="https://grass.osgeo.org/grass72/manuals/t.vect.extract.html">t.vect.extract</a>,
            <a href="https://grass.osgeo.org/grass72/manuals/t.rast.univar.html">t.rast.univar</a>,
            <a href="https://grass.osgeo.org/grass72/manuals/t.vect.univar.html">t.vect.univar</a>
        </li>
        <li>Spatio-temporal processing (a bit raster biased):
            <ul>
                <li>
                    data aggregation: <a href="https://grass.osgeo.org/grass72/manuals/t.rast.series.html">t.rast.series</a>,
                    <a href="https://grass.osgeo.org/grass72/manuals/t.rast.aggregate.html">t.rast.aggregate</a>,
                    <a href="https://grass.osgeo.org/grass72/manuals/t.rast.aggregate.ds.html">t.rast.aggregate.ds</a>
                </li>
                <li>
                    data accumulation: <a href="https://grass.osgeo.org/grass72/manuals/t.rast.accumulate.html">t.rast.accumulate</a>,
                    <a href="https://grass.osgeo.org/grass72/manuals/t.rast.accumulate.html">t.rast.accumulate</a>,
                </li>
                <li>
                    gap-filling and smoothing: <a href="https://grass.osgeo.org/grass72/manuals/t.rast.gapfill.html">t.rast.gapfill</a>,
                    <a href="https://grass.osgeo.org/grass72/manuals/t.rast.neighbors.html">t.rast.neighbors</a>
                </li>
                <li>
                    spatio-temporal algebra: <a href="https://grass.osgeo.org/grass72/manuals/t.rast.mapcalc.html">t.rast.mapcalc</a>,
                    <a href="https://grass.osgeo.org/grass72/manuals/t.rast.algebra.html">t.rast.algebra</a>,
                    <a href="https://grass.osgeo.org/grass72/manuals/t.vect.algebra.html">t.vect.algebra</a>
                </li>
            </ul>
        </li>
        <li>
            Visualization: <a href="https://grass.osgeo.org/grass72/manuals/g.gui.timeline.html">g.gui.timeline</a>,
            <a href="https://grass.osgeo.org/grass72/manuals/g.gui.tplot.html">g.gui.tplot</a>,
            <a href="https://grass.osgeo.org/grass72/manuals/g.gui.animation.html">g.gui.animation</a>,
            <a href="https://grass.osgeo.org/grass72/manuals/g.gui.mapswipe.html">g.gui.mapswipe</a>
        </li>
    </ol>

    <h2><a id="temporalhands">Hands-on to raster time series processing</a></h2>
    <h3>Getting the MODIS satellite sensor data</h3>
    MODIS is a payload scientific instrument on board the NASA Terra and the Aqua satellites with 36 spectral bands. Data are available for download upon <a href="https://urs.earthdata.nasa.gov/users/new">user registration</a>.
    <p>
    Create the <i>SETTING</i> file with the following content, e.g. in the directory <tt>$HOME/gisdata/</tt>:<br>
    <tt>
your_NASA_user<br>
your_NASA_password
    </tt>
    </p>
    <p>
    The <a href="https://grass.osgeo.org/grass72/manuals/addons/r.modis.download.html">r.modis.download</a> directly downloads from the MODIS data server: 
    <pre>
        <code class="neutral">
r.modis.download -g settings=$HOME/gisdata/SETTING product=lst_terra_monthly_5600 tiles=h11v05 startday="2015-01-01" endday="2016-12-31" folder=$HOME/lst_monthly
r.modis.import -w files=$HOME/lst_monthly/listfileMOD11B3.006.txt spectral="( 1 1 0 0 1 1 )" outfile=$HOME/lst_monthly/monthly_lst_to_register.txt
g.list type=raster pattern="MOD11B3*"
        </code>
        <code class="bash">
# Download data: MOD11B3 2015-2016, tile h11v05
r.modis.download -g settings=$HOME/gisdata/SETTING \
 product=lst_terra_monthly_5600 \
 tiles=h11v05 startday="2015-01-01" endday="2016-12-31" \
 folder=$HOME/lst_monthly

# Reproject from Sinusoidal to current NC projection and import maps into NC Location (Day and Night overpasses)
r.modis.import -w files=$HOME/lst_monthly/listfileMOD11B3.006.txt \
 spectral="( 1 1 0 0 1 1 )" \
 outfile=$HOME/lst_monthly/monthly_lst_to_register.txt

# Check list of imported maps
g.list type=raster pattern="MOD11B3*"
        </code>
        <code class="python">
# Import the needed libraries
import grass.pygrass.modules as gmod
import os
from subprocess import PIPE

# Set variables
# home
HOME=os.path.expanduser('~')
# stdout

# Download data: MOD11B3 2015-2016, tile h11v05
gmod.Module("r.modis.download", flags="g", settings=os.path.join(HOME, 'gisdata', 'SETTING'),
 product="lst_terra_monthly_5600", tiles="h11v05", startday="2015-01-01",
 endday="2016-12-31", folder=os.path.join(HOME, lst_monthly)

# Reproject and import maps into NC Location (Day and Night)
gmod.Module("r.modis.import", flags="w" files=os.path.join(HOME, 'lst_monthly', 'listfileMOD11B3.006.txt'),
 spectral="( 1 1 0 0 1 1 )", outfile=os.path.join(HOME, 'lst_monthly', 'monthly_lst_to_register.txt'))

# Check list of imported maps
glist = gmod.Module("g.list", type="raster", pattern="MOD11B3*", stdout_=PIPE, stderr_=PIPE)
 print(glist.outputs["stdout"].value)
        </code>
    </pre>
    <p>We will now visualize one of the MODIS LST images and add different map decorations. We first change the color palette from grey to viridis and set the computational region to the state of North Carolina (using <tt>nc_state</tt> vector map).</p>
    <p>
    <pre>
        <code class="neutral">
r.colors MOD11B3.A2015060.h11v05.single_LST_Day_6km color=viridis
g.region -p vector=nc_state
g.region -p raster=MOD11B3.A2015060.h11v05.single_LST_Day_6km
        </code>
        <code class="bash">
# Change color palette from grey to viridis
r.colors MOD11B3.A2015060.h11v05.single_LST_Day_6km color=viridis

# Set region to NC (g.region -d)
g.region -p vector=nc_state

# Optionally, to the full extent of one of the raster maps
g.region -p raster=MOD11B3.A2015060.h11v05.single_LST_Day_6km
        </code>
        <code class="python">
# Change color palette from grey to viridis
gmod.Module("r.colors", map="MOD11B3.A2015060.h11v05.single_LST_Day_6km", color="viridis")

# Set region to NC
gmod.Module("g.region", flags="p", vector="nc_state")

# Optionally, to the full extent of one of the raster maps
gmod.Module("g.region", flags="p", raster="MOD11B3.A2015060.h11v05.single_LST_Day_6km")
        </code>
    </pre>
    <p>We can open a monitor and run the commands from the command line or do everything in the main GUI and copy the commands for future reference or replication.</p>
    <pre>
        <code class="neutral">
# open a monitor
d.mon wx0

# display raster map
d.rast map=MOD11B3.A2015060.h11v05.single_LST_Day_6km

# display vector map
d.vect map=nc_state type=boundary

# add raster legend
d.legend -t -s -d -b raster=MOD11B3.A2015060.h11v05.single_LST_Day_6km \
 title=LST title_fontsize=20 font=sans fontsize=18

# add scale bar
d.barscale length=200 units=kilometers segment=4 fontsize=14

# add North arrow
d.northarrow style=1b text_color=black

# add text
d.text -b text="LST Day from MOD11B3.006 - North Carolina - March, 2015" \
 color=black bgcolor=229:229:229 align=cc font=sans size=8
        </code>
        <code class="gui">
        <!-- # add image: could really cool to have a video or a animated gif that show all the steps -->
		</code>
    </pre>
    <p style="text-align:center">
    <div class="imagebox">
        <img style="width: 700px;" src="figures/mod11b3_nc.png" alt="display LST map with decorations" title="display LST map with decorations"><br>
        MODIS LST map with decorations
    </div>
    </p>
    
    <h3>Create temporal raster dataset (STRDS)</h3>
    <p>
    To create a space-time raster data set (STRDS) implies to create an SQLite table in the temporal database, i.e.: a container table, that will hold our raster time series and will allow us to easily handle huge amounts of maps by only using the STRDS as input in temporal commands.
    <p>
    If this is the first time you use the temporal framework, you need to create and set the connection to the temporal database by means of <a href="https://grass.osgeo.org/grass72/manuals/t.connect.html" target="_blank">t.connect</a>. As the temporal database is mapset specific, you'll need to repeat this step in each mapset in which you'll have STDSs.
    <p>
    Once the connection is set, you can create the empty STRDS, i.e.: the empty table, in which you'll put (aka: register) all your time series maps afterwards. For the creation of any STDS, we need to specify which <b>type of maps</b> (raster, raster3d or vector) the STDS will contain and which <b>type of time</b> (absolute or relative) the maps represent. 
    <pre>
        <code class="neutral">
t.connect -d
t.create type=strds temporaltype=absolute output=LST_Day_monthly title="Monthly LST Day 5.6 km" description="Monthly LST Day 5.6 km MOD11B3.006, 2015-2016"
t.list type=strds
t.info input=LST_Day_monthly
        </code>
        <code class="bash">
# Create the temporal db connection
t.connect -d

# Create the STRDS
t.create type=strds temporaltype=absolute output=LST_Day_monthly \
 title="Monthly LST Day 5.6 km" \
 description="Monthly LST Day 5.6 km MOD11B3.006, 2015-2016"

# Check if the STRDS is created
t.list type=strds

# Get info about the STRDS
t.info input=LST_Day_monthly
        </code>
        <code class="python">
import grass.temporal as tgis

# Create the temporal db connection using temporal library
gmod.Module("t.connect", flags="d")

# Initialize the temporal library
tgis.init()

# Create the new STRDS
tgis.open_new_stds("LST_Day_monthly", "strds", "absolute", "Monthly LST Day 5.6 km",
                   "Monthly LST Day 5.6 km MOD11B3.006, 2015-2016", "mean", None, False)
# Connect to the SQL database interface
dbif = tgis.SQLDatabaseInterfaceConnection()
dbif.connect()

# Get and print the list of temporal dataset
stds_list = tgis.get_dataset_list("strds", "absolute", dbif=dbif)
print(stds_list)

# Get and print info about the created strds
dataset = tgis.dataset_factory("strds", "LST_Day_monthly@modis_lst")
dataset.select(dbif)
dataset.print_info()
        </code>
    </pre>
    <p>Once the STRDS is created, we add the maps into it, i.e.: we <i>register</i> maps in the STRDS. To register maps in a STDS, we need to pass the empty STDS as input and the list of maps to be registered. There are different ways to register maps in STDS, for more options, you can check the <a href="https://grass.osgeo.org/grass72/manuals/t.register.html" target="_blank">t.register</a> manual page and the related <a href="https://grasswiki.osgeo.org/wiki/Temporal_data_processing/maps_registration" target="_blank">wiki</a> page.</p>
    <p>Let's check now the basic info again to see how it looks like and list the raster maps in our <tt>LST_Day_monthly</tt> STRDS:</p>
    <pre>
        <code class="neutral">
t.register input=LST_Day_monthly file=$HOME/lst_monthly/monthly_lst_to_tregister.txt
t.info LST_Day_monthly
t.rast.list LST_Day_monthly
        </code>
        <code class="bash">
# Register maps in STRDS
t.register input=LST_Day_monthly \
 file=$HOME/lst_monthly/monthly_lst_to_tregister.txt

# Check info
t.info LST_Day_monthly

# Check the list of maps in the STRDS
t.rast.list LST_Day_monthly
        </code>
        <code class="python">
# Register maps using the Python function
tgis.register_maps_in_space_time_dataset(type="strds", name="LST_Day_monthly@modis_lst",
                                         file="$HOME/lst_monthly/monthly_lst_to_tregister.txt")
                                         
# Get info using the modules
gmod.Module("t.info", input="LST_Day_monthly")

# Get list of raster using the Python library
tgis.list_maps_of_stds("strds", "LST_Day_monthly@modis_lst", "name,mapset,start_time,end_time",
                       "start_time", "", "|", "cols", True, "no")
        </code>
    </pre>
    <p>Alternatively, we could have registered our raster maps using the <tt>maps</tt>, <tt>start</tt> and <tt>increment</tt> options along with the <tt>i</tt> flag for interval creation. The command in that case would look as follows:</p>
    <pre>
        <code class="neutral">
t.register -i input=LST_Day_monthly \
 maps=`g.list type=raster pattern=MOD11B3*LST_Day* separator=comma` \
 start="2015-01-01" increment="1 months"
        </code>
    </pre>
    <p>Let's see our STRDS graphically. We will use the <a href="https://grass.osgeo.org/grass72/manuals/g.gui.timeline.html" target="_blank">g.gui.timeline</a> tool. The tool g.gui.timeline is under the <em>Temporal</em> menu, in <em>GUI Tools</em> section. It can be called from the terminal with: <tt>g.gui.timeline --ui</tt>. To plot a STDS, it is necessary to select it first from the dropdown list and then click <em>Draw</em>. Alternatively, you can also get a 3D representation of the STDS (i.e.: x, y and time) by checking the 3D box. To change the padding settings of the plot you can click over the icon indicated bellow in the GUI tab.</p>
    <pre>
        <code class="neutral">
g.gui.timeline inputs=LST_Day_monthly
        </code>
        <code class="gui">
<div class="imagebox">
<img style="width: 700px;" src="figures/workflow_g_gui_timeline.png" alt="Workflow for plotting STRDS with g.gui.timeline" title="Workflow for plotting STRDS with g.gui.timeline"><br>
Workflow for plotting STRDS with g.gui.timeline
</div>
		</code>
    </pre>
    <div class="imagebox">
        <img style="width: 60%;" src="figures/g_gui_timeline_lst_monthly.png" alt="Timeline plot" title="Timeline plot for LST_Day_monthly time series"><br>
        Timeline plot for LST_Day_monthly time series
    </div>
    
    <h3>Temporal data analysis</h3>
    <p>
	One basic but very important function when handling hundreds or thousands of maps is the listing function, i.e.: we usually need to list maps that meet a certain condition. For example, we need maps which start month is June, maps with minimum values lower than 100, and so on. The GRASS GIS Temporal framework has different commands for that task: <a href="https://grass.osgeo.org/grass72/manuals/t.list.html" target="_blank">t.list</a> for listing STDS and maps registered in the temporal database, <a href="https://grass.osgeo.org/grass72/manuals/t.rast.list.html" target="_blank">t.rast.list</a> for raster time series and, <a href="https://grass.osgeo.org/grass72/manuals/t.vect.list.html" target="_blank">t.rast.list</a> for vector time series. All these commands allow us to list STDSs and/or maps according to different criteria. Let's see some examples with our <tt>LST_Day_monthly</tt> STRDS:</p>
    <pre>
        <code class="neutral">
# Maps with minimum value lower than or equal to 14000
t.rast.list input=LST_Day_monthly order=min \
 columns=name,start_time,min where="min <= '14000'"

name|start_time|min
MOD11B3.A2015032.h11v05.single_LST_Day_6km|2015-02-01 00:00:00|12950.0
MOD11B3.A2016032.h11v05.single_LST_Day_6km|2016-02-01 00:00:00|12964.0
MOD11B3.A2015001.h11v05.single_LST_Day_6km|2015-01-01 00:00:00|13022.0

# Maps with maximum value higher than 14000
t.rast.list input=LST_Day_monthly order=max \
 columns=name,start_time,max where="max > '14000'"

name|start_time|max
MOD11B3.A2016001.h11v05.single_LST_Day_6km|2016-01-01 00:00:00|14360.0
MOD11B3.A2015001.h11v05.single_LST_Day_6km|2015-01-01 00:00:00|14396.0
MOD11B3.A2015032.h11v05.single_LST_Day_6km|2015-02-01 00:00:00|14522.0

# Maps between two given dates
t.rast.list input=LST_Day_monthly columns=name,start_time \
 where="start_time >= '2015-05' and start_time <= '2015-08-01 00:00:00'"

name|start_time
MOD11B3.A2015121.h11v05.single_LST_Day_6km|2015-05-01 00:00:00
MOD11B3.A2015152.h11v05.single_LST_Day_6km|2015-06-01 00:00:00
MOD11B3.A2015182.h11v05.single_LST_Day_6km|2015-07-01 00:00:00
MOD11B3.A2015213.h11v05.single_LST_Day_6km|2015-08-01 00:00:00

# Maps from January
t.rast.list input=LST_Day_monthly columns=name,start_time \
 where="strftime('%m', start_time)='01'"
 
name|start_time
MOD11B3.A2015001.h11v05.single_LST_Day_6km|2015-01-01 00:00:00
MOD11B3.A2016001.h11v05.single_LST_Day_6km|2016-01-01 00:00:00

# Maps from June, 1st
t.rast.list input=LST_Day_monthly columns=name,start_time \
 where="strftime('%m-%d', start_time)='06-01'"

name|start_time
MOD11B3.A2015152.h11v05.single_LST_Day_6km|2015-06-01 00:00:00
MOD11B3.A2016153.h11v05.single_LST_Day_6km|2016-06-01 00:00:00
        </code>
    </pre>
    <p>
	To explore a bit more our time series, we will obtain univariate statistics for the maps in the STRDS. There's a dedicated module for that: <a href="https://grass.osgeo.org/grass72/manuals/t.rast.univar.html" target="_blank">t.rast.univar</a>. There's also the possibility to obtain extended statistics such as first quartile, median value, third quartile and percentile 90 by setting the <tt>e</tt> flag. Let's see:</p>
    <pre>
        <code class="neutral">
t.rast.univar input=LST_Day_monthly
			
id|start|end|mean|min|max|mean_of_abs|stddev|variance|coeff_var|sum|null_cells|cells
MOD11B3.A2015001.h11v05.single_LST_Day_6km@modis_lst|2015-01-01 00:00:00|2015-02-01 00:00:00|13920.4954589617|13022|14396|13920.4954589617|204.922713367766|41993.3184540075|1.47209353267553|329539889|51297|74970
MOD11B3.A2015032.h11v05.single_LST_Day_6km@modis_lst|2015-02-01 00:00:00|2015-03-01 00:00:00|13850.5832593907|12950|14522|13850.5832593907|269.511406162359|72636.3980516119|1.94584878567933|327801754|51303|74970
MOD11B3.A2015060.h11v05.single_LST_Day_6km@modis_lst|2015-03-01 00:00:00|2015-04-01 00:00:00|14387.8026526992|13771|14913|14387.8026526992|202.223782537869|40894.4582239235|1.40552235403321|340616840|51296|74970
MOD11B3.A2015091.h11v05.single_LST_Day_6km@modis_lst|2015-04-01 00:00:00|2015-05-01 00:00:00|14724.7657768016|14160|15212|14724.7657768016|127.152673621415|16167.8024090742|0.863529346060911|348594105|51296|74970

t.rast.univar -e input=LST_Day_monthly

id|start|end|mean|min|max|mean_of_abs|stddev|variance|coeff_var|sum|null_cells|cells|first_quartile|median|third_quartile|percentile_90
MOD11B3.A2015001.h11v05.single_LST_Day_6km@modis_lst|2015-01-01 00:00:00|2015-02-01 00:00:00|14063.8152535675|13625|14289|14063.8152535675|104.326695294161|10884.0593510007|0.741809341300163|12313517190|135054|1010600|14001|14076|14148|14183
MOD11B3.A2015032.h11v05.single_LST_Day_6km@modis_lst|2015-02-01 00:00:00|2015-03-01 00:00:00|14040.1111911881|13532|14349|14040.1111911881|128.052778812874|16397.5141616988|0.912049606083195|12292763193|135054|1010600|13944|14059|14140|14190
MOD11B3.A2015060.h11v05.single_LST_Day_6km@modis_lst|2015-03-01 00:00:00|2015-04-01 00:00:00|14509.6026765013|14012|14884|14509.6026765013|128.58386990137|16533.8115988123|0.886198421612294|12703824585|135054|1010600|14417|14523|14599|14664
MOD11B3.A2015091.h11v05.single_LST_Day_6km@modis_lst|2015-04-01 00:00:00|2015-05-01 00:00:00|14781.4240850852|14160|15128|14781.4240850852|116.594077815457|13594.1789816369|0.788787853892261|12941816732|135054|1010600|14724|14802|14859|14907

t.rast.univar input=LST_Day_monthly separator=comma output=stats_LST_Day_monthly.csv
        </code>
        <code class="bash">
# Print univariate stats for maps within STRDS
t.rast.univar input=LST_Day_monthly

# Get extended statistics and write the output to a csv file
t.rast.univar -e input=LST_Day_monthly separator=comma output=stats_LST_Day_monthly.csv
        </code>
        <code class="python">
# Print univarite statistics with the Python library
tgis.print_gridded_dataset_univar_statistics("strds", "LST_Day_monthly@modis_lst", None, None, False, False, ",", False)
        </code>
    </pre>
    <p>However, those statistics are a bit difficult to directly interpret since values are in &deg;K*50. Let's re-scale the data to &deg;C and run the previous command again. Then, we will set a proper color palette for the STRDS and display one map.</p>
    <p>To transform all the maps in our <tt>LST_Day_monthly</tt> time series into &deg;C we will use the <a href="https://grass.osgeo.org/grass72/manuals/t.rast.algebra.html" target="_blank">t.rast.algebra</a> module. This module allows to perform a very wide variety of operations in the temporal and spatial domains, as well as much of the more <i>"classic"</i> operations already available in <a href="https://grass.osgeo.org/grass72/manuals/r.mapcalc.html" target="_blank">r.mapcalc</a>.</p>
    <pre>
        <code class="neutral">
t.rast.algebra basename=LST_Day_monthly_celsius expression="LST_Day_monthly_celsius = LST_Day_monthly*0.02 - 273.15"
t.rast.univar input=LST_Day_monthly_celsius
t.rast.colors input=LST_Day_monthly_celsius color=celsius
        </code>
        <code class="bash">
# Re-scale data into degrees Celsius
t.rast.algebra basename=LST_Day_monthly_celsius \
 expression="LST_Day_monthly_celsius = (LST_Day_monthly*0.02) - 273.15"

# Print univariate stats
t.rast.univar input=LST_Day_monthly_celsius

# Set a dedicated color pallete
t.rast.colors input=LST_Day_monthly_celsius color=celsius
        </code>
        <code class="python">
# Re-scale data into degrees Celsius
gmod.Module("t.rast.algebra", basename="LST_Day_monthly_celsius",
            expression="LST_Day_monthly_celsius = (LST_Day_monthly*0.02) - 273.15")

# Print univarite statistics with the Python library
tgis.print_gridded_dataset_univar_statistics("strds", "LST_Day_monthly@modis_lst", None, None, False, False, ",", False)
gmod.Module("t.rast.colors", input="LST_Day_monthly_celsius", color="celsius")
        </code>
    </pre>
    <div class="imagebox">
        <img style="width: 70%;" src="figures/lst_modis_celsius.png" alt="LST MODIS in degrees Celsius" title="LST MODIS in degrees Celsius"><br>
        MODIS LST re-scaled to degrees Celsius
    </div>
    <p>Alternatively, we could have used <a href="https://grass.osgeo.org/grass72/manuals/t.rast.mapcalc.html" target="_blank">t.rast.mapcalc</a> to perform the previous transformation:</p>
    <pre>
        <code class="neutral">
t.rast.mapcalc input=LST_Day_monthly output=LST_Day_monthly_celsius basename=LST_Day_monthly_celsius expression="LST_Day_monthly*0.02 - 273.15"
		</code>
	</pre>
	
    <h3>Temporal aggregations</h3>
    <p>There are basically two dedicated modules to perform temporal aggregations in GRASS GIS. The first that we will use is <a href="https://grass.osgeo.org/grass72/manuals/t.rast.series.html" target="_blank">t.rast.series</a>. This module is a wrapper for <a href="https://grass.osgeo.org/grass72/manuals/r.series.html" target="_blank">r.series</a> and allows us to aggregate our STRDS or parts of it with different methods. We will use it now to obtain the absolute maximum LST in the past two years.</p>
    <pre>
        <code class="neutral">
t.rast.series input=LST_Day_monthly_celsius output=LST_Day_max method=maximum
r.colors map=LST_Day_max color=celsius
d.mon wx0
d.rast LST_Day_max
d.legend LST_Day_max
        </code>
        <code class="bash">
# Get maximum LST in the STRDS
t.rast.series input=LST_Day_monthly_celsius \
 output=LST_Day_max method=maximum

# Change color pallete to celsius
r.colors map=LST_Day_max color=celsius

# Display the new map
d.mon wx0
d.rast LST_Day_max
d.legend LST_Day_max
        </code>
        <code class="python">
# Get maximum LST in the STRDS
gmod.Module("t.rast.series", input="LST_Day_monthly_celsius",
            output="LST_Day_max" method="maximum")
        </code>
    </pre>
    </pre>
    <div class="imagebox">
        <img style="width: 70%;" src="figures/month_max_lst.png" alt="Month of maximum LST" title="Month of maximum LST"><br>
        Month of maximum LST for the period 2015-2016
    </div>
    <p>Now, by means of the spatio-temporal algebra, we will get the month in which the absolute maximum LST occurred. For that, we will first compare our <tt>LST_Day_monthly_celsius</tt> STRDS with the map of absolute maximum LST <tt>LST_Day_max</tt>. If they coincide, we keep the month for that pixel, otherwise it will be NULL. Then, we aggregate the resulting <tt>month_max_lst</tt> STRDS with <tt>t.rast.series method=maximum</tt> and we get the map with the pixelwise month in which the absolute maximum LST have occurred in the past two years. Finally, we remove the intermediate STRDS, since we are only interested in the aggregated map</p>
    <pre>
        <code class="neutral">
t.rast.mapcalc -n inputs=LST_Day_monthly_celsius output=month_max_lst expression="if(LST_Day_monthly_celsius == LST_Day_max, start_month(), null())" basename=month_max_lst
t.rast.series input=month_max_lst method=maximum output=max_lst_date
t.remove -rf inputs=month_max_lst
        </code>
        <code class="bash">
# New strds with month of overall maximum
t.rast.mapcalc -n inputs=LST_Day_monthly_celsius output=month_max_lst \
 expression="if(LST_Day_monthly_celsius == LST_Day_max, start_month(), null())" \
 basename=month_max_lst

# Get basic info
t.info month_max_lst

# Map with month of overall maximum
t.rast.series input=month_max_lst method=maximum output=max_lst_date

# Remove month_max_lst strds (we were only interested in the resulting aggregated map)
t.remove -rf inputs=month_max_lst
        </code>
        <code class="python">
# New strds with month of overall maximum
gmod.Module("t.rast.mapcalc", flags="n", inputs="LST_Day_monthly_celsius", output="month_max_lst",
            expression="if(LST_Day_monthly_celsius == LST_Day_max_2015_2016, start_month(), null())",
            basename="month_max_lst")
            
# Map with month of overall maximum
gmod.Module("t.rast.series", input="month_max_lst", method="maximum", output="max_lst_date")

# Remove month_max_lst strds
gmod.Module("t.remove", flags="rf", inputs="month_max_lst")
        </code>
    </pre>
    <p>Note that the flags <tt>"-rf"</tt> force (immediate) removal of both the STRDS (i.e.: the container table) and the maps registered in it.</p>
    <p>Finally, we display the resulting map:</p>
    <pre>
        <code class="neutral">
d.mon wx0
d.rast max_lst_date
d.legend max_lst_date
        </code>
    </pre>
    <!-- plot here -->
    <p>The other module that allows us to perform temporal aggregations is <a href="https://grass.osgeo.org/grass72/manuals/t.rast.aggregate.html" target="_blank">t.rast.aggregate</a>. With this module we are able to aggregate raster maps in our STRDS with different granularities. Note that this module also has the option <tt>where</tt> that allow us to set specific dates for the aggregation. We will use this module to get 3-month and 6-month average LST.</p>
    <pre>
        <code class="neutral">
t.rast.aggregate input=LST_Day_monthly_celsius output=LST_Day_mean_3month basename=LST_Day_mean_3month suffix=gran method=average granularity="3 months"
t.info LST_Day_mean_3month
t.rast.list LST_Day_mean_3month

t.rast.aggregate input=LST_Day_monthly_celsius output=LST_Day_mean_6month basename=LST_Day_mean_6month suffix=gran method=average granularity="6 months"
t.info LST_Day_mean_6month
t.rast.list LST_Day_mean_6month
        </code>
        <code class="bash">
# 3-month mean LST
t.rast.aggregate input=LST_Day_monthly_celsius \
 output=LST_Day_mean_3month \
 basename=LST_Day_mean_3month suffix=gran \
 method=average granularity="3 months"

# Print info
t.info LST_Day_mean_3month

# Print list of maps
t.rast.list LST_Day_mean_3month

# 6-month mean LST
t.rast.aggregate input=LST_Day_monthly_celsius \
 output=LST_Day_mean_6month \
 basename=LST_Day_mean_6month suffix=gran \
 method=average granularity="6 months"

# Print info
t.info LST_Day_mean_6month

# Print list of maps
t.rast.list LST_Day_mean_6month
        </code>
        <code class="python">
# 3-month mean LST
gmod.Module("t.rast.aggregate", input="LST_Day_monthly_celsius", output="LST_Day_mean_3month",
            basename="LST_Day_mean_3month", suffix="gran", method="average", granularity="3 months")

# 6-month mean LST
gmod.Module("t.rast.aggregate", input="LST_Day_monthly_celsius", output="LST_Day_mean_6month",
            basename="LST_Day_mean_6month", suffix="gran", method="average", granularity="6 months")
        </code>
    </pre>
    <p>Now, we will extract the 3-month mean LST for points in a vector map. We will use the vector map <tt>comm_colleges</tt> that is already available in the PERMANENT mapset of NC Location. There are different commands that allow us to perform this task, but we'll use <a href="" target="_blank">v.what.strds</a>. This module allows to extract values for more than one STRDS and (optionally) to write the output to the attribute table of the input vector map.</p>
    <pre>
        <code class="neutral">
v.what.strds input=comm_colleges strds=LST_Day_mean_3month,LST_Day_mean_6month output=comm_colleges_lst
v.db.select map=comm_colleges_lst file=ts_points.csv
        </code>
        <code class="bash">
# Extract data from raster maps in the STRDSs and write to a new vector map
v.what.strds input=comm_colleges strds=LST_Day_mean_3month,LST_Day_mean_6month \
 output=comm_colleges_lst
 
# Save the attribute table of the new vector into a csv file
v.db.select map=comm_colleges_lst file=ts_points.csv

# Alternatively, update attr table of the input vector map
v.what.strds -u input=comm_colleges strds=LST_Day_mean_3month,LST_Day_mean_6month
v.db.select map=comm_colleges
        </code>
        <code class="python">
# Extract data from raster maps in the STRDSs and write to a new vector map
gmod.Module("v.what.strds", input="comm_colleges", output="comm_colleges_lst",
            strds="LST_Day_mean_3month,LST_Day_mean_6month")

# Save the attribute table of the new vector into a csv file
gmod.Module("v.db.select", map="comm_colleges_lst", file="ts_points.csv")
        </code>
    </pre>
    <p>Alternatively, we could use <a href="" target="_blank">t.rast.what</a> that samples a STRDS at specific vector point coordinates and write the output to stdout using different layouts. For example:</p>
    <pre>
        <code class="neutral">
t.rast.what points=comm_colleges strds=LST_Day_mean_6month output=trastwhat_output.csv null_value=NA separator=comma
        </code>
        <code class="bash">
t.rast.what points=comm_colleges strds=LST_Day_mean_6month output=trastwhat_output.csv \
 null_value=NA separator=comma
        </code>
        <code class="python">
gmod.Module("t.rast.what", points="comm_colleges", strds="LST_Day_mean_6month",
            output="trastwhat_output.csv", null_value="NA", separator="comma")
        </code>
    </pre>
    <p>You might explore the options available in the parameter <tt>layout</tt> to see the different ways to write the output.</p>
    <p>Even though the most common is to extract raster data to points, we may also be interested in getting spatially aggregated time series data for polygons. GRASS GIS has an add-on for this: <a href="https://grass.osgeo.org/grass72/manuals/addons/v.strds.stats.html" target="_blank">v.strds.stats</a>. It calculates zonal statistics of each raster in a STRDS and writes the output to the attribute table of a new polygon vector map. We first need to install the add-on through <a href="https://grass.osgeo.org/grass72/manuals/g.extension.html">g.extension</a>. Then, we will extract the average, minimum and maximum monthly LST for municipalities in NC during 2015 and 2016. Note: if it takes too long, change <tt>boundary_municp</tt> by <tt>boundary_wake</tt>.</p>
    <pre>
        <code class="neutral">
g.extension v.strds.stats
v.strds.stats input=boundary_municp strds=LST_Day_monthly_celsius output=munic_aggr_lst method=average,minimum,maximum
v.db.select map=munic_aggr_lst file=ts_polygons.csv
        </code>
        <code class="bash">
# Install v.strds.stats add-on
g.extension v.strds.stats

# Extract mean, max and min LST for municipalities
v.strds.stats input=boundary_municp strds=LST_Day_monthly_celsius \
 output=munic_aggr_lst method=average,minimum,maximum

# Save the attribute table of the new vector into a csv file
v.db.select map=munic_aggr_lst file=ts_polygons.csv
        </code>
        <code class="python">
# Install v.strds.stats add-on
gmod.Module("g.extension", extension="v.strds.stats")

# Extract mean, max and min LST for municipalities
gmod.Module("v.strds.stats", input="boundary_municp", output="munic_aggr_lst",
            strds="LST_Day_monthly_celsius", method="average,minimum,maximum")

# Save the attribute table of the new vector into a csv file
gmod.Module("v.db.select", map="munic_aggr_lst", file="ts_polygons.csv")
        </code>
    </pre>
    </p>
    <h3>Temporal data visualization</h3>
    <pre>
        <code class="neutral">
g.gui.mapswipe
        </code>
        <code class="gui">
        <!-- # add image -->
		</code>
    </pre>
    <pre>
        <code class="neutral">
g.gui.animation
        </code>
        <code class="gui">
        <!-- # add image -->
		</code>
    </pre>
    <pre>
        <code class="neutral">
g.gui.tplot
        </code>
        <code class="gui">
        <!-- # add image -->
		</code>
    </pre>
    <h2>Other (very) useful links</h2>
    <ul>
        <li><a href="https://ncsu-osgeorel.github.io/grass-intro-workshop/" target="_blank">https://ncsu-osgeorel.github.io/grass-intro-workshop/</a></li>
        <li>
            <a href="https://grasswiki.osgeo.org/wiki/Unleash_the_power_of_GRASS_GIS_at_US-IALE_2017" target="_blank">https://grasswiki.osgeo.org/wiki/Unleash_the_power_of_GRASS_GIS_at_US-IALE_2017</a>
        </li>
        <li><a href="https://grasswiki.osgeo.org/wiki/Temporal_data_processing" target="_blank">https://grasswiki.osgeo.org/wiki/Temporal_data_processing</a></li>
        <li><a href="http://ncsu-geoforall-lab.github.io/grass-temporal-workshop/" target="_blank">http://ncsu-geoforall-lab.github.io/grass-temporal-workshop/</a></li>
        <li>
            <a href="https://grasswiki.osgeo.org/wiki/Temporal_data_processing/GRASS_R_raster_time_series_processing" target="_blank">https://grasswiki.osgeo.org/wiki/Temporal_data_processing/GRASS_R_raster_time_series_processing</a>
        </li>
    </ul>
    <h2>References</h2>
    <ul>
        <li>Gebbert, S., Pebesma, E. (2014). <em>A temporal GIS for field based environmental modeling</em>. Environmental Modelling & Software, 53, 1–12. <a href="https://doi.org/10.1016/j.envsoft.2013.11.001" target="_blank">DOI</a></li>
        <li>Gebbert, S., Pebesma, E. (2017). <em>The GRASS GIS temporal framework</em>. International Journal of Geographical Information Science 31, 1273-1292. <a href="http://dx.doi.org/10.1080/13658816.2017.1306862" target="_blank">DOI</a></li>
        <li>Neteler, M., Bowman, M.H., Landa, M. and Metz, M. (2012): <em>GRASS GIS: a multi-purpose Open Source GIS</em>. Environmental Modelling & Software, 31: 124-130 <a href="http://dx.doi.org/10.1016/j.envsoft.2011.11.014" target="_blank">DOI</a></li>
        <li>Neteler, M., Mitasova, H. (2008): <em>Open Source GIS: A GRASS GIS Approach</em>. Third edition. ed. Springer, New York. <a href="https://grassbook.org/" target="_blank">Book site</a></li>
    </ul>
    </p>
    <hr>
  </div>

</body>
</html>
